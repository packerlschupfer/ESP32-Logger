; PlatformIO Project Configuration File for Logger Blocking Test
;
; This test verifies whether blocking issues come from our Logger
; implementation or from ESP32 Serial hardware

[env:esp32dev]
platform = espressif32
board = esp32dev
framework = arduino

; Serial configuration
upload_port = /dev/ttyACM0
monitor_port = /dev/ttyACM0
monitor_speed = 115200
monitor_filters = 
    direct
    esp32_exception_decoder

; Build configuration
build_flags = 
    -D CORE_DEBUG_LEVEL=5
    ; Default serial buffer size (can be changed for testing)
    -D SERIAL_TX_BUFFER_SIZE=128
    -D CONFIG_ARDUINO_SERIAL_BUFFER_SIZE=128
    ; Enable custom logger implementation
    -D USE_CUSTOM_LOGGER

; Library dependencies - Logger is symlinked in lib/
lib_deps = 
    
; For testing with larger buffer (uncomment to test)
; [env:esp32dev_large_buffer]
; extends = env:esp32dev
; build_flags = 
;     -D CORE_DEBUG_LEVEL=5
;     -D SERIAL_TX_BUFFER_SIZE=2048
;     -D CONFIG_ARDUINO_SERIAL_BUFFER_SIZE=2048
    
; For testing with faster baud rate (uncomment to test)
; [env:esp32dev_fast_baud]
; extends = env:esp32dev
; monitor_speed = 921600

; Test with slower baud rate to reproduce blocking
[env:esp32dev_slow_baud]
extends = env:esp32dev
monitor_speed = 9600
build_flags = 
    ${env:esp32dev.build_flags}
    -D SLOW_BAUD_TEST